using Terraria;
using Terraria.ID;
using Terraria.ModLoader;
using Microsoft.Xna.Framework;

public class DamageReducerShield : ModProjectile
{
    public override void SetStaticDefaults()
    {
        DisplayName.SetDefault("Damage Reducer Shield");
    }

    public override void SetDefaults()
    {
        Projectile.width = 296;
        Projectile.height = 296;
        Projectile.friendly = false;
        Projectile.hostile = false;
        Projectile.penetrate = -1;
        Projectile.timeLeft = 600;
        Projectile.tileCollide = false;
        Projectile.ignoreWater = true;
    }

    public override void AI()
    {
        // Кручение снаряда
        Projectile.rotation += 0.1f;

        // Перебираем все снаряды в мире
        for (int i = 0; i < Main.maxProjectiles; i++)
        {
            Projectile other = Main.projectile[i];

            // Проверяем: другой снаряд жив, дружественный и не этот
            if (other.active && other.friendly && other != Projectile)
            {
                // Проверка на столкновение хитбоксов
                if (Projectile.Hitbox.Intersects(other.Hitbox))
                {
                    // Уменьшаем урон на 15%
                    other.damage = (int)(other.damage * 0.85f);

                    // Добавим эффект или визуал (опционально)
                    Dust.NewDust(other.position, other.width, other.height, DustID.MagicMirror);

                    // Однократно уменьшаем — можно сделать флаг, если нужно
                }
            }
        }
    }
}
